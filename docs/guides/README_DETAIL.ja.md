# SRT Probe - 詳細ガイド

> 🌐 **Languages**: [English](README_DETAIL.md) | [日本語](README_DETAIL.ja.md) | [中文](README_DETAIL.zh.md) | [한국어](README_DETAIL.ko.md) | [Español](README_DETAIL.es.md)

このドキュメントでは、SRT Probe の詳細な機能説明と使用方法について解説します。

## 📖 SRT プロトコルとは

SRT（Secure Reliable Transport）は、インターネット上で高品質な映像・音声をリアルタイムに配信するために開発されたオープンソースのプロトコルです。

### SRT の主な特徴
- **低遅延**: 従来の配信プロトコルよりも遅延が少ない
- **パケットロス補正**: ネットワークが不安定でもデータを正確に配信
- **暗号化対応**: AES暗号化によるセキュアな通信
- **ファイアウォール越え**: NATやファイアウォール環境でも動作

### 使用例
- SRTツールの接続テスト
- ライブストリーミング配信（スポーツ中継、イベント配信など）
- 放送局間の映像伝送
- リモート制作（REMI: Remote Integration Model）
- クラウドベースの映像制作

## ✨ 全機能一覧

### 🌍 5言語対応
- English、日本語、中文、한국어、Españolに対応

### 📊 リアルタイム統計

SRT Probe は、接続中のネットワーク品質を以下の指標でリアルタイムに表示します：

#### RTT (Round Trip Time)
ラウンドトリップ時間。データが送信先に届いて戻ってくるまでの時間です。

#### Throughput（スループット）
データの転送速度を Mbps（メガビット毎秒）で表示します。

#### Packet Loss（パケットロス）
送信したパケットのうち、失われたパケットの割合（%）です。

### 📈 パフォーマンスチャート

Chart.js を使用した動的なグラフで、以下の情報を時系列で表示します：

- **RTT チャート**: 遅延の推移を視覚化
- **スループットチャート**: 転送速度の変動を表示
- **パケットロスチャート**: ネットワーク品質の変化を監視

### 🔄 3つの接続モード

SRT Probe は、SRTプロトコルの3つの接続モードに対応しています：

#### 1. CALLER（クライアント）モード
- **役割**: 接続を開始する側（クライアント）
- **用途**: 配信元から配信先へ接続する場合
- **設定**: 接続先のIPアドレスとポート番号を指定

**使用例：**
```
Sender (caller) → Receiver (listener)
配信元がサーバーに接続してデータを送信
```

#### 2. LISTENER（サーバー）モード
- **役割**: 接続を待ち受ける側（サーバー）
- **用途**: 配信先として待機する場合
- **設定**: 待ち受けるポート番号を指定（IPは通常 0.0.0.0）

**使用例：**
```
Sender (listener) ← Receiver (caller)
配信元がサーバーとして待機し、受信側から接続を受ける
```

#### 3. RENDEZVOUS（ランデブー）モード
- **役割**: 双方が同時に接続を試みる（P2P）
- **用途**: ファイアウォールやNAT越えが必要な場合
- **設定**: 両側で同じポート番号を使用

**使用例：**
```
Sender (rendezvous) ⇄ Receiver (rendezvous)
両側が同時に接続を開始（対等な関係）
```

### 💾 プリセット機能

よく使う設定を保存して、次回から簡単に呼び出せます。

#### プリセットの保存
1. 接続設定（IP、ポート、モードなど）を入力
2. **Save** ボタンをクリック
3. プリセット名を入力（例: "本社サーバー"、"東京拠点"）
4. 保存をクリック

#### プリセットの読み込み
1. ドロップダウンから保存済みのプリセットを選択
2. **Load** ボタンをクリック
3. 設定が自動的に入力されます

#### プリセットの削除
1. ドロップダウンから削除したいプリセットを選択
2. **Delete** ボタンをクリック

### 🎨 3パネル構成UI

SRT Probe のUIは、3つのパネルで構成されています：

#### 左パネル: 設定入力
- **Test Mode**: 送信/受信モードの選択
- **Connection Settings**: IP、ポート番号の設定
- **Advanced Settings**: 詳細設定（後述）
- **Preset Management**: プリセットの保存・読み込み

#### 右上パネル: リアルタイム統計
- **接続状態**: Connected / Disconnected
- **RTT**: リアルタイム遅延表示
- **Throughput**: スループット表示
- **Packet Loss**: パケットロス率表示
- **Performance Chart**: 時系列グラフ

#### 右下パネル: ログ出力
- **リアルタイムログ**: 接続状態やエラーメッセージ
- **ログフィルター**: Debug / Info / Warn / Error でフィルタリング
- **ログクリア**: ログ表示をクリア

## ⚙️ 詳細設定（Advanced Settings）

**Advanced Settings** を展開すると、以下の設定を調整できます：

### Interval（データ送信間隔）
- **説明**: データパケットを送信する間隔（ミリ秒）
- **デフォルト**: 100ms
- **推奨値**:
  - 高頻度テスト: 50-100ms
  - 通常テスト: 100-500ms
  - 低頻度テスト: 500-1000ms

### Data Size（送信データサイズ）
- **説明**: 1回の送信で送るデータサイズ（バイト）
- **デフォルト**: 1316バイト（SRT推奨値）
- **推奨値**:
  - 標準: 1316バイト（MTU 1500に最適化）
  - 小サイズ: 512-1024バイト
  - 大サイズ: 2048-4096バイト

### Log Level（ログレベル）
- **説明**: 表示するログの詳細度
- **レベル**:
  - **Debug**: すべてのログを表示（開発・デバッグ用）
  - **Info**: 通常の動作ログを表示（推奨）
  - **Warn**: 警告とエラーのみ表示
  - **Error**: エラーのみ表示（最小限）

### Verbose Output（詳細ログ出力）
- **説明**: より詳細なログ情報を出力
- **用途**: トラブルシューティング時に有効化
- **注意**: ログ量が増えるため、通常は無効でOK

### Duration（テスト時間）
- **説明**: テストの自動停止時間（秒）
- **デフォルト**: 0（無制限）
- **推奨値**:
  - 短期テスト: 10-60秒
  - 長期テスト: 300-3600秒（5分〜1時間）

## 🎯 使用シナリオ別ガイド

### シナリオ 1: ネットワークでのテスト

**目的**: 社内LANでのSRT接続確認

**設定：**
1. **Receiver側**:
   - Mode: Receiver (listener)
   - IP: 0.0.0.0
   - Port: 9000

2. **Sender側**:
   - Mode: Sender (caller)
   - IP: 192.168.1.100（Receiver IPアドレス）
   - Port: 9000

**期待される結果：**
- RTT: 1-10ms
- Packet Loss: 0-0.1%
- Throughput: ネットワーク速度に依存（通常100Mbps〜1Gbps）

### シナリオ 2: インターネット経由の配信テスト（逆接続パターン）

**目的**: 拠点間でのSRT配信品質確認（配信元をサーバーとして使用）

**設定：**
1. **配信元（Sender）**:
   - Mode: Sender (listener)
   - IP: 0.0.0.0
   - Port: 9000
   - ファイアウォールでポート9000を開放

2. **配信先（Receiver）**:
   - Mode: Receiver (caller)
   - IP: [配信元のグローバルIP]
   - Port: 9000

**使用例：**
配信元側にファイアウォール設定の権限がある場合、または配信元を固定サーバーとして運用する場合に有効です。

**期待される結果：**
- RTT: 20-150ms（距離に依存）
- Packet Loss: 0.1-1%
- Throughput: 回線速度に依存

### シナリオ 3: ファイアウォール越えのP2Pテスト

**目的**: 両側がファイアウォール内にある場合のテスト

**設定：**
1. **両側とも同じ設定**:
   - Mode: Rendezvous
   - IP: 相手側のグローバルIP
   - Port: 9000
   - 両側で同時に「Start Test」をクリック

**注意事項：**
- UPnPが有効な環境で推奨
- または手動でポートフォワーディング設定が必要

## 🔍 統計の読み方とトラブルシューティング

### 正常な接続の例

```
Status: Connected
RTT: 25ms
Throughput: 8.5 Mbps
Packet Loss: 0.05%
```
→ 問題なし。高品質な接続です。

### 高遅延の例

```
Status: Connected
RTT: 450ms
Throughput: 2.1 Mbps
Packet Loss: 0.2%
```
→ RTTが高い。長距離接続または経路に問題がある可能性。

**対処法：**
- ネットワーク経路を確認
- traceroute で中継ルーターを調査
- ISPに問い合わせ

### 高パケットロスの例

```
Status: Connected
RTT: 35ms
Throughput: 4.2 Mbps
Packet Loss: 8.5%
```
→ パケットロスが高い。ネットワークが不安定。

**対処法：**
- Wi-Fi の場合は有線LANに変更
- 帯域幅が不足している可能性（他の通信を停止）
- ネットワーク機器（ルーター、スイッチ）を再起動

### 低スループットの例

```
Status: Connected
RTT: 18ms
Throughput: 0.3 Mbps
Packet Loss: 0.1%
```
→ スループットが低い。帯域制限がある可能性。

**対処法：**
- Interval を短くする（より頻繁にデータ送信）
- Data Size を大きくする
- ネットワーク帯域幅を確認

## 📞 サポートとフィードバック

### サポート窓口

SRT Probe に関するご質問やお困りの点がございましたら、以下の方法でお問い合わせください：

#### GitHub Issues
技術的な問題やバグ報告は、[GitHub Issues](https://github.com/videosupporter/srt-probe/issues) でご報告いただけます。

以下の情報を含めていただくと、迅速な対応が可能です：
- Windows バージョン
- SRT Probe バージョン
- エラーメッセージ（あれば）
- 再現手順
- ログファイル

#### メールサポート
一般的なお問い合わせ: videosp.info@gmail.com

### よくある質問（FAQ）

よくある質問については、[トラブルシューティングガイド](TROUBLESHOOTING.ja.md) のFAQセクションを参照してください。

